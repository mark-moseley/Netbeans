/*
 *                 Sun Public License Notice
 * 
 * The contents of this file are subject to the Sun Public License
 * Version 1.0 (the "License"). You may not use this file except in
 * compliance with the License. A copy of the License is available at
 * http://www.sun.com/
 * 
 * The Original Code is Forte for Java, Community Edition. The Initial
 * Developer of the Original Code is Sun Microsystems, Inc. Portions
 * Copyright 1997-2000 Sun Microsystems, Inc. All Rights Reserved.
 */

package com.netbeans.developer.modules.loaders.form;

import java.util.Vector;
import org.openide.TopManager;
import org.openide.NotifyDescriptor;

/** 
 *
 * @author  Pavel Buzek
 * @version 
 */

public class EventCustomEditor extends javax.swing.JDialog {

  /** Creates new form EventCustomEditor */
  public EventCustomEditor(java.awt.Frame parent, boolean modal, RADComponent.EventProperty eventProperty) {
    super (parent, modal);
    this.eventProperty = eventProperty;
    changes = eventProperty.new HandlerSetChange ();
    setTitle ("Handlers for " + eventProperty.event.getName ());
    initComponents ();
  }

  /** This method is called from within the constructor to
   * initialize the form.
   * WARNING: Do NOT modify this code. The content of this method is
   * always regenerated by the FormEditor.
   */
  private void initComponents () {//GEN-BEGIN:initComponents
    Vector h = eventProperty.event.getHandlers ();
    for (int i=0, n=h.size (); i<n; i++) {
      handlersModel.addElement (((EventsManager.EventHandler) (h.get (i))).getName ());
    }
    handlersList = new javax.swing.JList ();
    handlersList.setModel (handlersModel);
    addButton = new javax.swing.JButton ();
    removeButton = new javax.swing.JButton ();
    renameButton = new javax.swing.JButton ();
    jPanel1 = new javax.swing.JPanel ();
    okButton = new javax.swing.JButton ();
    cancelButton = new javax.swing.JButton ();
    getContentPane ().setLayout (new java.awt.GridBagLayout ());
    java.awt.GridBagConstraints gridBagConstraints1;
    addWindowListener (new java.awt.event.WindowAdapter () {
      public void windowClosing (java.awt.event.WindowEvent evt) {
        closeDialog (evt);
      }
    }
    );



    gridBagConstraints1 = new java.awt.GridBagConstraints ();
    gridBagConstraints1.gridheight = 6;
    gridBagConstraints1.fill = java.awt.GridBagConstraints.BOTH;
    gridBagConstraints1.insets = new java.awt.Insets (8, 8, 8, 8);
    gridBagConstraints1.weightx = 0.9;
    gridBagConstraints1.weighty = 1.0;
    getContentPane ().add (handlersList, gridBagConstraints1);

    addButton.setText ("Add");
    addButton.addActionListener (new java.awt.event.ActionListener () {
      public void actionPerformed (java.awt.event.ActionEvent evt) {
        jButton1ActionPerformed (evt);
      }
    }
    );


    gridBagConstraints1 = new java.awt.GridBagConstraints ();
    gridBagConstraints1.gridx = 1;
    gridBagConstraints1.gridy = 0;
    gridBagConstraints1.fill = java.awt.GridBagConstraints.HORIZONTAL;
    gridBagConstraints1.insets = new java.awt.Insets (8, 8, 0, 8);
    gridBagConstraints1.weightx = 0.1;
    getContentPane ().add (addButton, gridBagConstraints1);

    removeButton.setText ("Remove");
    removeButton.addActionListener (new java.awt.event.ActionListener () {
      public void actionPerformed (java.awt.event.ActionEvent evt) {
        jButton2ActionPerformed (evt);
      }
    }
    );


    gridBagConstraints1 = new java.awt.GridBagConstraints ();
    gridBagConstraints1.gridx = 1;
    gridBagConstraints1.gridy = 1;
    gridBagConstraints1.fill = java.awt.GridBagConstraints.HORIZONTAL;
    gridBagConstraints1.insets = new java.awt.Insets (8, 8, 0, 8);
    gridBagConstraints1.weightx = 0.1;
    getContentPane ().add (removeButton, gridBagConstraints1);

    renameButton.setText ("Rename");
    renameButton.addActionListener (new java.awt.event.ActionListener () {
      public void actionPerformed (java.awt.event.ActionEvent evt) {
        jButton3ActionPerformed (evt);
      }
    }
    );


    gridBagConstraints1 = new java.awt.GridBagConstraints ();
    gridBagConstraints1.gridx = 1;
    gridBagConstraints1.gridy = 2;
    gridBagConstraints1.fill = java.awt.GridBagConstraints.HORIZONTAL;
    gridBagConstraints1.insets = new java.awt.Insets (8, 8, 0, 8);
    gridBagConstraints1.weightx = 0.1;
    getContentPane ().add (renameButton, gridBagConstraints1);


      okButton.setText ("Ok");
      okButton.addActionListener (new java.awt.event.ActionListener () {
        public void actionPerformed (java.awt.event.ActionEvent evt) {
          jButton6ActionPerformed (evt);
        }
      }
      );
  
      jPanel1.add (okButton);
  
      cancelButton.setText ("Cancel");
      cancelButton.addActionListener (new java.awt.event.ActionListener () {
        public void actionPerformed (java.awt.event.ActionEvent evt) {
          cancelButtonActionPerformed (evt);
        }
      }
      );
  
      jPanel1.add (cancelButton);
  

    gridBagConstraints1 = new java.awt.GridBagConstraints ();
    gridBagConstraints1.gridx = 0;
    gridBagConstraints1.gridy = 6;
    gridBagConstraints1.gridwidth = 2;
    gridBagConstraints1.fill = java.awt.GridBagConstraints.BOTH;
    gridBagConstraints1.anchor = java.awt.GridBagConstraints.EAST;
    getContentPane ().add (jPanel1, gridBagConstraints1);

    pack ();
  }//GEN-END:initComponents

private void cancelButtonActionPerformed (java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cancelButtonActionPerformed
// Add your handling code here:
  dispose ();
  }//GEN-LAST:event_cancelButtonActionPerformed

private void jButton6ActionPerformed (java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton6ActionPerformed
// Add your handling code here:
  try {
    eventProperty.setValue (changes);
  } catch (java.lang.reflect.InvocationTargetException e1) {
    e1.printStackTrace();
  } catch (IllegalAccessException e2) {
    e2.printStackTrace();
  }
  dispose ();
  }//GEN-LAST:event_jButton6ActionPerformed

private void jButton3ActionPerformed (java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton3ActionPerformed
// Add your handling code here:
  NotifyDescriptor.InputLine nd = new NotifyDescriptor.InputLine ("New name for handler:", "Rename handler");
  Object[] handlers = handlersList.getSelectedValues();
  for (int i=0, n=handlers.length; i<n; i++) {
    nd.setInputText((String)handlers[i]);
    if (TopManager.getDefault().notify(nd).equals (NotifyDescriptor.OK_OPTION)) {
      changes.getRenamedOldNames ().add (handlers[i]);
      changes.getRenamedNewNames ().add (nd.getInputText());
      int pos = handlersModel.indexOf(handlers[i]);
      handlersModel.remove(pos);
      handlersModel.add(pos, nd.getInputText());
    }
  }  
  }//GEN-LAST:event_jButton3ActionPerformed

private void jButton2ActionPerformed (java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton2ActionPerformed
// Add your handling code here:
  Object[] handlers = handlersList.getSelectedValues();
  for (int i=0, n=handlers.length; i<n; i++) {
    changes.getRemoved ().add (handlers[i]);
    handlersModel.removeElement(handlers[i]);
  }  
  }//GEN-LAST:event_jButton2ActionPerformed

private void jButton1ActionPerformed (java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
// Add your handling code here:
  NotifyDescriptor.InputLine nd = new NotifyDescriptor.InputLine ("New handler name:", "Add handler");
  if (TopManager.getDefault().notify(nd).equals (NotifyDescriptor.OK_OPTION)) {
    changes.getAdded ().add (nd.getInputText());
    handlersModel.addElement(nd.getInputText());
  }  
  }//GEN-LAST:event_jButton1ActionPerformed

  /** Closes the dialog */
  private void closeDialog(java.awt.event.WindowEvent evt) {//GEN-FIRST:event_closeDialog
    setVisible (false);
    dispose ();
  }//GEN-LAST:event_closeDialog


  // Variables declaration - do not modify//GEN-BEGIN:variables
  private javax.swing.JList handlersList;
  private javax.swing.JButton addButton;
  private javax.swing.JButton removeButton;
  private javax.swing.JButton renameButton;
  private javax.swing.JPanel jPanel1;
  private javax.swing.JButton okButton;
  private javax.swing.JButton cancelButton;
  // End of variables declaration//GEN-END:variables
  RADComponent.EventProperty eventProperty;
  javax.swing.DefaultListModel handlersModel = new javax.swing.DefaultListModel ();
  RADComponent.EventProperty.HandlerSetChange changes;

}

/*
 * Log
 *  1    Gandalf   1.0         11/25/99 Pavel Buzek     
 * $
 */
