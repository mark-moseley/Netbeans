<html>
<head>
<style>
div { white-space: pre; font-family: monospace; margin: 0px; padding: 0px }
.covered { background-color: CCFFCC }
.not_covered { background-color: FFCCCC }
.inferred { background-color: E0FFE0 }
.unknown { background-color: EEEEEE }
</style>
</head>
<body>
<h1>File Coverage for md5driver.py</h1>
<div class="covered">import string</div>
<div class="covered">import md5</div>
<div class="covered">from sys import argv</div>
<div class="unknown"></div>
<div class="covered">def MDPrint(str):</div>
<div class="covered">    outstr = ''</div>
<div class="covered">    for i in str:</div>
<div class="covered">        o = ord(i)</div>
<div class="covered">        outstr = (outstr</div>
<div class="unknown">                  + string.hexdigits[(o >> 4) &amp; 0xF]</div>
<div class="unknown">                  + string.hexdigits[o &amp; 0xF])</div>
<div class="covered">    print outstr,</div>
<div class="inferred"></div>
<div class="inferred"></div>
<div class="covered">from time import time</div>
<div class="unknown"></div>
<div class="covered">def makestr(start, end):</div>
<div class="not_covered">    result = ''</div>
<div class="not_covered">    </div>
<div class="not_covered">    for i in range(start, end + 1):</div>
<div class="not_covered">        result = result + chr(i)</div>
<div class="not_covered"></div>
<div class="not_covered">    return result</div>
<div class="not_covered"></div>
<div class="not_covered"></div>
<div class="covered">def MDTimeTrial():</div>
<div class="not_covered">    TEST_BLOCK_SIZE = 1000</div>
<div class="not_covered">    TEST_BLOCKS = 10000</div>
<div class="not_covered"></div>
<div class="not_covered">    TEST_BYTES = TEST_BLOCK_SIZE * TEST_BLOCKS</div>
<div class="not_covered"></div>
<div class="not_covered">    # initialize test data, need temporary string filler</div>
<div class="not_covered"></div>
<div class="not_covered">    filsiz = 1 &lt;&lt; 8</div>
<div class="not_covered">    filler = makestr(0, filsiz-1)</div>
<div class="not_covered">    data = filler * (TEST_BLOCK_SIZE // filsiz)</div>
<div class="not_covered">    data = data + filler[:(TEST_BLOCK_SIZE % filsiz)]</div>
<div class="not_covered"></div>
<div class="not_covered">    del filsiz, filler</div>
<div class="not_covered"></div>
<div class="not_covered"></div>
<div class="not_covered">    # start timer</div>
<div class="not_covered">    print 'MD5 time trial. Processing', TEST_BYTES, 'characters...'</div>
<div class="not_covered">    t1 = time()</div>
<div class="not_covered"></div>
<div class="not_covered">    mdContext = md5.new()</div>
<div class="not_covered"></div>
<div class="not_covered">    for i in range(TEST_BLOCKS):</div>
<div class="not_covered">        mdContext.update(data)</div>
<div class="not_covered"></div>
<div class="not_covered">    str = mdContext.digest()</div>
<div class="not_covered">    t2 = time()</div>
<div class="not_covered"></div>
<div class="not_covered">    MDPrint(str)</div>
<div class="not_covered">    print 'is digest of test input.'</div>
<div class="not_covered">    print 'Seconds to process test input:', t2 - t1</div>
<div class="not_covered">    print 'Characters processed per second:', TEST_BYTES / (t2 - t1)</div>
<div class="not_covered"></div>
<div class="not_covered"></div>
<div class="covered">def MDString(str):</div>
<div class="not_covered">    MDPrint(md5.new(str).digest())</div>
<div class="not_covered">    print '"' + str + '"'</div>
<div class="not_covered"></div>
<div class="not_covered"></div>
<div class="covered">def MDFile(filename):</div>
<div class="not_covered">    f = open(filename, 'rb')</div>
<div class="not_covered">    mdContext = md5.new()</div>
<div class="not_covered"></div>
<div class="not_covered">    while 1:</div>
<div class="not_covered">        data = f.read(1024)</div>
<div class="not_covered">        if not data:</div>
<div class="not_covered">            break</div>
<div class="not_covered">        mdContext.update(data)</div>
<div class="not_covered"></div>
<div class="not_covered">    MDPrint(mdContext.digest())</div>
<div class="not_covered">    print filename</div>
<div class="not_covered"></div>
<div class="not_covered"></div>
<div class="covered">import sys</div>
<div class="inferred"></div>
<div class="inferred"># This comment should be</div>
<div class="inferred"># inferred as part of the previous one</div>
<div class="covered">def MDFilter():</div>
<div class="covered">    mdContext = md5.new()</div>
<div class="inferred"></div>
<div class="covered">    while 1:</div>
<div class="covered">        data = sys.stdin.read(16)</div>
<div class="covered">        if not data:</div>
<div class="not_covered">            break</div>
<div class="not_covered">        mdContext.update(data)</div>
<div class="not_covered"></div>
<div class="covered">    MDPrint(mdContext.digest())</div>
<div class="covered">    print</div>
<div class="unknown"></div>
<div class="unknown"></div>
<div class="covered">def MDTestSuite():</div>
<div class="not_covered">    print 'MD5 test suite results:'</div>
<div class="not_covered">    MDString('')</div>
<div class="not_covered">    MDString('a')</div>
<div class="not_covered">    MDString('abc')</div>
<div class="not_covered">    MDString('message digest')</div>
<div class="not_covered">    MDString(makestr(ord('a'), ord('z')))</div>
<div class="not_covered">    MDString(makestr(ord('A'), ord('Z'))</div>
<div class="not_covered">              + makestr(ord('a'), ord('z'))</div>
<div class="not_covered">              + makestr(ord('0'), ord('9')))</div>
<div class="not_covered">    MDString((makestr(ord('1'), ord('9')) + '0') * 8)</div>
<div class="not_covered"></div>
<div class="not_covered">    # Contents of file foo are "abc"</div>
<div class="not_covered">    MDFile('foo')</div>
<div class="not_covered"></div>
<div class="not_covered"></div>
<div class="inferred"># I don't wanna use getopt(), since I want to use the same i/f...</div>
<div class="covered">def main():</div>
<div class="covered">    if len(argv) == 1:</div>
<div class="covered">        MDFilter()</div>
<div class="covered">    for arg in argv[1:]:</div>
<div class="not_covered">        if arg[:2] == '-s':</div>
<div class="not_covered">            MDString(arg[2:])</div>
<div class="not_covered">        elif arg == '-t':</div>
<div class="not_covered">            MDTimeTrial()</div>
<div class="not_covered">        elif arg == '-x':</div>
<div class="not_covered">            MDTestSuite()</div>
<div class="not_covered">        else:</div>
<div class="not_covered">            MDFile(arg)</div>
<div class="not_covered"></div>
<div class="covered">main()</div>

</body></html>
