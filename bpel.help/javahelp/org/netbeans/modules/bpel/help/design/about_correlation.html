<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!--
* Copyright 2007 Sun Microsystems, Inc. All rights reserved.
* Use is subject to license terms.
-->
<html>
<head>
<title>BPEL Designer: Understanding Correlation</title>
<link rel="stylesheet" href="nbdocs://org.netbeans.modules.usersguide/org/netbeans/modules/usersguide/ide.css" type="text/css">
<style type="text/css">
<!--
.style1 {color: #CC0000}
-->
</style>
</head>
<body>
<h2>BPEL Designer: Understanding Correlation</h2>
<p><small><a href="#seealso">See Also</a></small></p>
<p>The BPEL Service Engine runtime uses a mechanism called <i>correlation</i> to track the 
multiple, stateful, long-running exchanges of messages that typically take 
place between a
BPEL process and its partner services. A message in such a conversation 
is mapped   to a composite value made up of one or more properties  defined in a WSDL file.  </p>
<p>Thus,  correlation sets are  used to support stateful collaboration between web services in a  standardized, implementation independent way. Correlation sets rely on  the correlation data tokens stored in the message envelopes, headers,  or business documents themselves. The declaration of correlation relies  on the declarative properties of messages. A property is  a field  within a message identified by a query. Queries are specified by  special constructs called property aliases.</p>
<p>The following terms apply to correlation: </p>
<ul>
  <li>A <i>property</i> is an abitrarily named token. It must be a  primitive type. It is defined in  a WSDL file.<br>
  </li>
  <li>A <i>property alias</i> is a rule that tells the BPEL runtime  how to map data from a message into a property value. You can define  several property aliases for a property that will be used as a  correlation value. You would do this if the same property value needs  to be mapped from more than one message, which is typical in  correlation.&nbsp; This property alias is defined in a WSDL file.<br>
  </li>
  <li>A <i>correlation set</i> is a compound key made up of one or more   property values. The BPEL runtime uses this key to ensure that  messages are routed to the right process instance for a particular  conversation. Correlation sets are defined in a BPEL file.
</li>
</ul>
<h3>Elements That Use and Express Correlation </h3>
<p>Correlation sets can be defined for the Process element. The defined correlation sets are then used by message activities (<a href="../elements/invoke.html" title="Invoke">Invoke</a>, <a href="../elements/reply.html" title="Reply">Reply</a>, and <a href="../elements/receive.html" title="Receive">Receive</a>), which describe a conversation between a process and a partner service.</p>
<p>Correlation sets on Invoke activities are used to verify that 
outbound messages contain data that is consistent with the data found 
within specified correlation set instances. </p>
<p>Correlation set names are also used in the <tt>onMessage</tt> branches 
of <a href="../elements/pick.html" title="Pick">Pick</a> elements. </p>
<h3>Correlation in Four Steps</h3>
<p>Follow these four basic steps to enable correlation in a process:</p>
<ol>
  <li>Define one or more properties in the WSDL file <a href="nbdocs://org.netbeans.modules.xml.wsdlui/org/netbeans/modules/xml/wsdlui/docs/wsdl_editor_prop.html" title="Configuring Properties and Property Aliases Using the WSDL View">using the WSDL Editor</a> or <a href="add_props_navigator.html">using the Navigator window</a>. </li>
  <li>Define property aliases in the WSDL file <a href="nbdocs://org.netbeans.modules.xml.wsdlui/org/netbeans/modules/xml/wsdlui/docs/wsdl_editor_prop.html" title="Configuring Properties and Property Aliases Using the WSDL View">using the WSDL Editor</a> or <a href="add_props_navigator.html">using the Navigator window</a>.</li>
  <li>Define a <a href="create_correlation_set.html#define_corr" title="Adding Correlation Sets">correlation set</a> for the Process on the BPEL diagram, using one or more of the properties.</li>
  <li> <a href="create_correlation_set.html#add_corr" title="Adding Correlation Sets">Associate</a> one or more correlation sets with a message that is  sent or received in an Invoke, Receive, Reply, or Pick activity. </li>
</ol>
<h3><a name="corr_attributes"></a>Correlation Set Attributes</h3>
<p> When a correlation set is defined, it has <tt>name</tt> and <tt>property</tt> attributes. A correlation set within a synchronous Invoke activity has an additional attribute: <tt>pattern</tt>. This attribute specifies whether the correlation set applies to the request message, the response message, or both. </p>
<p>The initiate attribute indicates whether the correlation set is to be initiated with the message's property values. When the initiate attribute has the value <tt>Yes</tt>, the correlation set is initiated with the values of the properties found in the message. If an initiate attribute is missing, it has the default value <tt>No</tt>. The fault <tt>bpws:correlationViolation</tt> is thrown if an activity with <tt>initiate=No</tt> tries to use a correlation set that has not been initiated before. When the initiate attribute has the value <tt>Join</tt>, the activity must attempt to initiate the correlation set, if it has not yet been initiated.</p>
<dl>
<dt><a name="seealso">See Also</a></dt>
<dd><a href="create_correlation_set.html" title="Adding Correlation Sets">Adding Correlation Sets</a></dd>
<dd><a href="nbdocs://org.netbeans.modules.xml.wsdlui/org/netbeans/modules/xml/wsdlui/docs/wsdl_editor_prop.html" title="Configuring Properties and Property Aliases Using the WSDL View">Configuring Properties and Property Aliases Using the WSDL View</a></dd>
</dl>
<hr>
<small>  
<a href="../credits.html">Legal Notices</a></small>
<table border="0" cellpadding="150">
<tr><td>&nbsp;</td></tr>
<tr><td>&nbsp;</td></tr>
<tr><td>&nbsp;</td></tr>
</table>
</body>
</html>

