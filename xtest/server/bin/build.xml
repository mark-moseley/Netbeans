<?xml version="1.0"?>

<project name="Xtest driver" basedir="." default="start">

   <property name="xtest.testing.base" location=".."/>

   <property name="xtest.home"          location="${xtest.testing.base}/xtest-dist"/>
   <property name="ide.installto"       location="${xtest.testing.base}/ide" />
   <property name="xtest.driver.config" location="${xtest.testing.base}/driver.properties"/>
   <property name="xtest.results"       location="${xtest.testing.base}/results"/>
   <property name="xtest.workdir"       location="${xtest.testing.base}/work"/>
   <property name="xtest.driver.backup" location="${xtest.testing.base}/backup"/>
   
   <property name="xtest.config.suffix" value=""/>

   <target name="start">
   
       <ant dir="${xtest.testing.base}" antfile="${xtest.home}/lib/driver.xml" target="start"/>

       <taskdef name="get-system-property" classname="org.netbeans.xtest.GetSystemProperty" classpath="${xtest.home}/lib/xtest.jar"/>
       <get-system-property systemProperty="xtest.errors"/>
       <antcall target="mail-errors"/>
   </target>
   
   <target name="mail-errors" if="xtest.errors">
       <exec executable="sh" failonerror="true">
          <arg value="mail.sh"/>
          <arg value="TR WARNING: Some module(s) failed."/>
          <arg value="Host: ${xtest.machine}${line.separator}Project: ${xtest.tested.project}${line.separator}Problem: Some module buildscript(s) failed${line.separator}${line.separator}This may be caused by problems in tests, but it can also be caused by problems in test infrastructure. Despite it results still should appear on web after some time. Open results for this project/build/machine and look at buildscript logs for details. They are located under link 'Logs from builds scripts'.${line.separator}${line.separator}Found errors:${line.separator}${xtest.errors}"/>
       </exec>
   </target>
</project>