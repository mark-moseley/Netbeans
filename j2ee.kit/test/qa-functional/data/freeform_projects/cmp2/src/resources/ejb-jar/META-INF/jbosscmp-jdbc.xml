<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE jbosscmp-jdbc PUBLIC   
   "-//JBoss//DTD JBOSSCMP-JDBC 3.0//EN"
   "http://www.jboss.org/j2ee/dtd/jbosscmp-jdbc_3_0.dtd">

<jbosscmp-jdbc>
   <defaults>
      <datasource>java:/DefaultDS</datasource>
      <datasource-mapping>Hypersonic SQL</datasource-mapping>
      <create-table>true</create-table>
      <remove-table>true</remove-table>
      <pk-constraint>true</pk-constraint>
      <preferred-relation-mapping>foreign-key</preferred-relation-mapping>
   </defaults>

   <enterprise-beans>

      <entity>
         <ejb-name>OrganizationEJB</ejb-name>
         <table-name>organization</table-name>

         <cmp-field>
            <field-name>name</field-name>
            <column-name>name</column-name>
         </cmp-field>
         <cmp-field>
            <field-name>description</field-name>
            <column-name>desc</column-name>
            <not-null/>
         </cmp-field>
      </entity>

      <entity>
         <ejb-name>GangsterEJB</ejb-name>
         <table-name>gangster</table-name>

         <cmp-field>
            <field-name>gangsterId</field-name>
            <column-name>id</column-name>
         </cmp-field>
         <cmp-field>
            <field-name>name</field-name>
            <column-name>name</column-name>
            <not-null/>
         </cmp-field>
         <cmp-field>
            <field-name>nickName</field-name>
            <column-name>nick_name</column-name>
            <jdbc-type>VARCHAR</jdbc-type>
            <sql-type>VARCHAR(64)</sql-type>
         </cmp-field>
         <cmp-field>
            <field-name>badness</field-name>
            <column-name>badness</column-name>
         </cmp-field>
      </entity>

      <entity>
         <ejb-name>JobEJB</ejb-name>
         <table-name>job</table-name>

         <cmp-field>
            <field-name>name</field-name>
            <column-name>name</column-name>
         </cmp-field>
         <cmp-field>
            <field-name>score</field-name>
            <column-name>score</column-name>
         </cmp-field>
         <cmp-field>
            <field-name>setupCost</field-name>
            <column-name>setup_cost</column-name>
         </cmp-field>
      </entity>
   </enterprise-beans>

   <relationships>
      <ejb-relation>
         <ejb-relation-name>Organization-Gangster</ejb-relation-name>
         <foreign-key-mapping/>

         <ejb-relationship-role> 
            <ejb-relationship-role-name>org-has-gangsters</ejb-relationship-role-name>
            <key-fields>
               <key-field>
                  <field-name>name</field-name>
                  <column-name>organization</column-name>
               </key-field>
            </key-fields>
         </ejb-relationship-role> 

         <ejb-relationship-role> 
            <ejb-relationship-role-name>gangster-belongs-to-org</ejb-relationship-role-name>
            <key-fields/>
         </ejb-relationship-role> 
      </ejb-relation> 

      <ejb-relation>
         <ejb-relation-name>Gangster-Jobs</ejb-relation-name>
         <relation-table-mapping>
            <table-name>gangster_job</table-name>
         </relation-table-mapping>

         <ejb-relationship-role> 
            <ejb-relationship-role-name>gangster-has-jobs</ejb-relationship-role-name>
            <key-fields>
               <key-field>
                  <field-name>gangsterId</field-name>
                  <column-name>gangster</column-name>
               </key-field>
            </key-fields>
         </ejb-relationship-role> 

         <ejb-relationship-role> 
            <ejb-relationship-role-name>job-has-gangsters</ejb-relationship-role-name>
            <key-fields>
               <key-field>
                  <field-name>name</field-name>
                  <column-name>job</column-name>
               </key-field>
            </key-fields>
         </ejb-relationship-role> 
      </ejb-relation> 

      <ejb-relation>
         <ejb-relation-name>Organization-Boss</ejb-relation-name>
         <foreign-key-mapping/>

         <ejb-relationship-role> 
            <ejb-relationship-role-name>organization-has-a-boss</ejb-relationship-role-name>
            <key-fields/>
         </ejb-relationship-role> 

         <ejb-relationship-role> 
            <ejb-relationship-role-name>boss-runs-an-organization</ejb-relationship-role-name>
            <key-fields>
               <key-field>
                  <field-name>gangsterId</field-name>
                  <column-name>the_boss</column-name>
               </key-field>
            </key-fields>
         </ejb-relationship-role> 
      </ejb-relation> 
   </relationships>
</jbosscmp-jdbc>
