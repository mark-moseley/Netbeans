<xsl:comment>ricoh-run</xsl:comment>

    <target name="ricoh-run" if="ricoh-platform.trigger">
        <copy todir="${{platform.home}}/mnt/sd3/sdk/dsdk/dist/${{ricoh.application.uid}}" overwrite="true">
            <fileset dir="${{dist.dir}}">
                <patternset refid="deployment.patternset"/>
            </fileset>
        </copy>
        <taskIf if="ricoh.application.type" value="xlet">
            <ant antfile="${{platform.home}}/startemulator.xml" target="start_emulator" dir="${{platform.home}}">
                <property name="emulator.skin" value="WVGA.xml"/>
                <property name="emulator.autolaunchid" value="${{ricoh.application.uid}}"/>
            </ant>
        </taskIf>
        <taskIf if="ricoh.application.type" value="servlet">
            <echo message="Starting OSGI framework..."/>
            <ant antfile="${{ricoh.osgi.path}}/startOsgiFramework.xml" target="startup" dir="${{ricoh.osgi.path}}"/>
            <java classname="org.knopflerfish.framework.Main" fork="true">
                <classpath>
                    <pathelement location="${{ricoh.osgi.path}}/framework.jar"/>
                    <pathelement location="${{ricoh.osgi.path}}/serverservice.jar"/>
                    <pathelement location="${{ricoh.osgi.path}}/tomcat_lib/container/jasper.jar"/>
                    <pathelement location="${{ricoh.osgi.path}}/tomcat_lib/common/jasper-runtime.jar"/>
                    <pathelement location="${{ricoh.osgi.path}}/jars/jsdk/jdsk-2.2.jar"/>
                    <pathelement location="${{ricoh.osgi.path}}/jars/http/http_api-1.1.0.jar"/>
                    <pathelement location="${{ricoh.osgi.path}}/jars/util/util-1.0.0.jar"/>
                </classpath>
                <arg line="-xargs init.xargs"/>
            </java>
        </taskIf>
    </target>
