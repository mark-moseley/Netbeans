#!/bin/sh

if [ x$BUILD_ID = x ]
then
    # Non-Hudson use.
    if [ x$USERNAME = x ]
    then
        BUILD_ID=private
    else
        BUILD_ID=$USERNAME-private
    fi
    dir=`dirname $0`/../..
    cd $dir
else
    hg up -C . # in case previous build mistakenly modified some source files
    hg --config extensions.purge= clean --all || exit
fi

set -e
ant -Dcluster.config=python build
ant -f python.editor/build-python.xml runtests
ant -Dcluster.config=python commit-validation 

